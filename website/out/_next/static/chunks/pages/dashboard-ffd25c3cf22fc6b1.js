(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[26],{1015:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/dashboard",function(){return s(448)}])},9555:function(e,t,s){"use strict";var n=s(5893),r=s(7294),a=s(1163),l=s(4926);t.Z=e=>{let{children:t}=e,s=(0,a.useRouter)(),{user:o,loading:i}=(0,r.useContext)(l.AuthContext);return((0,r.useEffect)(()=>{i||o||s.push("/login?redirect=".concat(encodeURIComponent(s.asPath)))},[o,i,s]),i)?(0,n.jsx)("div",{className:"min-h-screen flex justify-center items-center bg-gray-50",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):o?t:null}},448:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return j}});var n=s(5893),r=s(7294),a=s(5369),l=s(9555),o=s(2914),i=s(2191),d=s(4926),c=s(1163),m=s(6450),u=s(109),x=s(1594),h=e=>{let{showCodeSnippet:t,handleCloseCodeSnippet:s,handleCopyCodeSnippet:r,generateCodeSnippet:a,selectedProviderForSnippet:l,setSelectedProviderForSnippet:i,buttonSettings:d,handleButtonSettingChange:c,handleSaveSettings:u,colorOptions:h}=e;return t?(0,n.jsx)("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:(0,n.jsxs)("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,n.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,n.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75",onClick:s})}),(0,n.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,n.jsxs)("div",{className:"relative inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-6xl sm:w-full",children:[(0,n.jsx)("div",{className:"absolute top-0 right-0 hidden pt-4 pr-4 sm:block z-10",children:(0,n.jsxs)("button",{type:"button",className:"rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:s,children:[(0,n.jsx)("span",{className:"sr-only",children:"Close"}),(0,n.jsx)(x.Z,{className:"h-6 w-6","aria-hidden":"true"})]})}),(0,n.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,n.jsx)("div",{className:"sm:flex sm:items-start",children:(0,n.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full",children:[(0,n.jsxs)("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4 flex items-center",children:[(0,n.jsx)(o.mGS,{className:"mr-2 text-blue-500"}),"Integration Code Snippet"]}),(0,n.jsx)("div",{className:"mb-6 bg-gray-50 p-4 rounded-lg border border-gray-200",children:(0,n.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(o.tvD,{className:"text-blue-600 mr-2"}),(0,n.jsx)("h4",{className:"text-sm font-medium text-gray-700",children:"Select Payment Provider:"})]}),(0,n.jsxs)("div",{className:"flex space-x-2",children:[(0,n.jsx)("button",{onClick:()=>i("stripe"),type:"button",className:"px-4 py-2 text-sm font-medium rounded-md focus:outline-none transition-all ".concat("stripe"===l?"bg-blue-600 text-white shadow-sm":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"Stripe"}),(0,n.jsx)("button",{onClick:()=>i("paddle"),type:"button",className:"px-4 py-2 text-sm font-medium rounded-md focus:outline-none transition-all ".concat("paddle"===l?"bg-blue-600 text-white shadow-sm":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50"),children:"Paddle"})]})]})}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,n.jsx)("div",{children:(0,n.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,n.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-4 flex items-center",children:[(0,n.jsx)(o._TT,{className:"mr-2 text-purple-500"}),"Customize Button"]}),(0,n.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg mb-4 flex flex-col items-center",children:[(0,n.jsx)("p",{className:"text-xs text-gray-500 mb-3 self-start",children:"Preview"}),(0,n.jsx)("div",{className:"p-4 border border-dashed border-gray-300 rounded-lg flex justify-center w-full",children:(0,n.jsx)("button",{type:"button",className:"px-4 py-2 rounded text-white shadow-sm transition-all hover:shadow-md",style:{backgroundColor:d.buttonColor},children:d.buttonText})})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"buttonText",className:"block text-sm font-medium text-gray-700 mb-1",children:"Button Text"}),(0,n.jsx)("input",{type:"text",id:"buttonText",value:d.buttonText,onChange:e=>c("buttonText",e.target.value),className:"block w-full border border-gray-300 rounded-md shadow-sm py-2 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,n.jsxs)("div",{className:"mb-4",children:[(0,n.jsx)("label",{htmlFor:"buttonColor",className:"block text-sm font-medium text-gray-700 mb-2",children:"Button Color"}),(0,n.jsxs)("div",{className:"flex items-center mb-3 bg-gray-50 p-2 rounded-md",children:[(0,n.jsx)("input",{type:"color",id:"colorPicker",value:d.buttonColor,onChange:e=>c("buttonColor",e.target.value),className:"h-8 w-8 rounded border border-gray-300 cursor-pointer mr-2"}),(0,n.jsx)("input",{type:"text",id:"buttonColor",value:d.buttonColor,onChange:e=>c("buttonColor",e.target.value),className:"flex-1 border border-gray-300 rounded-md shadow-sm py-1.5 px-3 text-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-1",children:h.map(e=>(0,n.jsx)("div",{className:"h-8 w-full rounded-md cursor-pointer border transition-all ".concat(d.buttonColor===e.value?"ring-2 ring-offset-1 ring-blue-500 scale-105":"border-gray-300 hover:ring-1 hover:ring-blue-300"),style:{backgroundColor:e.value},onClick:()=>c("buttonColor",e.value),title:e.name},e.value))})]}),(0,n.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,n.jsx)("h5",{className:"text-xs font-medium text-gray-700 mb-2",children:"Options"}),(0,n.jsxs)("div",{className:"space-y-3",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{id:"testMode",name:"testMode",type:"checkbox",checked:d.testMode,onChange:e=>c("testMode",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:"testMode",className:"ml-2 block text-sm text-gray-700",children:"Test Mode (No actual cancellations)"})]}),(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("input",{id:"customBranding",name:"customBranding",type:"checkbox",checked:d.customBranding,onChange:e=>c("customBranding",e.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"}),(0,n.jsx)("label",{htmlFor:"customBranding",className:"ml-2 block text-sm text-gray-700",children:"Custom Branding (Modal Text)"})]})]})]}),(0,n.jsx)("button",{type:"button",onClick:u,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:text-sm transition-colors",children:"Save Settings"})]})}),(0,n.jsx)("div",{className:"lg:col-span-2",children:(0,n.jsxs)("div",{className:"bg-white rounded-lg border border-gray-200 shadow-sm overflow-hidden",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between bg-gray-800 px-4 py-3",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)(o.tvD,{className:"text-blue-400 mr-2"}),(0,n.jsx)("span",{className:"text-sm font-medium text-gray-200",children:"Integration Code"})]}),(0,n.jsxs)("button",{onClick:r,className:"text-sm bg-blue-600 hover:bg-blue-700 text-white py-1.5 px-3 rounded-md flex items-center transition-colors",children:[(0,n.jsx)(o.esY,{className:"mr-1.5"}),"Copy Code"]})]}),(0,n.jsx)("div",{className:"bg-gray-900 overflow-hidden",children:(0,n.jsx)("pre",{className:"p-4 text-gray-100 text-sm overflow-x-auto max-h-[300px] scrollbar-thin scrollbar-thumb-gray-700 scrollbar-track-gray-900",children:a()})}),(0,n.jsxs)("div",{className:"p-4 bg-white border-t border-gray-200",children:[(0,n.jsxs)("div",{className:"flex items-center mb-3",children:[(0,n.jsx)(o.DAO,{className:"text-blue-600 mr-2"}),(0,n.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:"Implementation Guide"})]}),(0,n.jsxs)("div",{className:"rounded-md bg-blue-50 p-4 mb-4",children:[(0,n.jsxs)("div",{className:"flex items-center mb-2",children:[(0,n.jsx)(o.iih,{className:"text-amber-500 mr-2"}),(0,n.jsx)("h4",{className:"text-md font-medium text-gray-800",children:"Quick Start"})]}),(0,n.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm text-gray-700",children:[(0,n.jsx)("li",{children:"Copy the full code snippet above"}),(0,n.jsx)("li",{children:"Paste it directly into your HTML file where you want the cancel button to appear"}),(0,n.jsxs)("li",{children:["Replace ",(0,n.jsx)("code",{className:"bg-gray-100 px-1 py-0.5 rounded text-xs",children:'"THE_END_USERS_ACTUAL_SUBSCRIPTION_ID"'})," with the actual subscription ID"]})]})]}),(0,n.jsxs)("div",{className:"mt-4 mb-3",children:[(0,n.jsx)("h4",{className:"text-md font-medium text-gray-800 mb-2",children:"Advanced Integration"}),(0,n.jsx)("p",{className:"text-sm text-gray-600 mb-3",children:"For modular applications (React, Vue, Angular):"}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-md p-3 border border-gray-200 mb-3",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Example (React Component):"}),(0,n.jsx)("div",{className:"bg-gray-100 p-2 rounded-md text-xs overflow-x-auto",children:(0,n.jsx)("pre",{children:"import React, { useEffect, useRef } from 'react';\n\n// 1. Ensure CancelReady script is loaded in your main HTML file:\n// <script src=\"https://cancelready.web.app/cancel\"></script>\n\nconst CancelButton = ({ vendorKey, subscriptionId, paymentProvider, buttonText, testMode, onSuccess, onError }) => {\n  const targetEl = useRef(null);\n\n  useEffect(() => {\n    if (window.CancelReady && targetEl.current) {\n      window.CancelReady.init({\n        targetElement: targetEl.current, // Pass the DOM element directly\n        vendorKey,\n        subscriptionId,\n        paymentProvider,\n        buttonText,\n        testMode,\n        onSuccess,\n        onError\n      });\n    } else if (!window.CancelReady) {\n      console.error('CancelReady script not loaded yet.');\n    }\n  }, [vendorKey, subscriptionId, paymentProvider, buttonText, testMode, onSuccess, onError]);\n\n  return <div ref={targetEl}></div>; // CancelReady will populate this div\n};\n\nexport default CancelButton;"})})]}),(0,n.jsxs)("div",{className:"bg-gray-50 rounded-md p-3 border border-gray-200",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Example (Vanilla JS):"}),(0,n.jsx)("div",{className:"bg-gray-100 p-2 rounded-md text-xs overflow-x-auto",children:(0,n.jsx)("pre",{children:"// 1. Ensure CancelReady script is loaded:\n// ".concat('<script src="https://cancelready.web.app/cancel"></script>',"\n\n").concat("// Example Usage:\ninitCancelReadyButton({\n  targetDivId: 'cr-target-div',\n  vendorKey: 'YOUR_VENDOR_KEY',\n  subscriptionId: 'USER_SUBSCRIPTION_ID',\n  paymentProvider: 'stripe',\n  buttonText: 'Request Cancellation'\n});")})})]})]}),(0,n.jsx)("div",{className:"mt-4",dangerouslySetInnerHTML:{__html:(0,m.u)()}}),(0,n.jsx)("div",{className:"mt-4 p-3 bg-amber-50 rounded-md border border-amber-100",children:(0,n.jsx)("p",{className:"text-sm font-medium text-amber-800",children:"Always test the cancellation flow in your development environment before deploying to production."})})]})]})})]})]})})}),(0,n.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,n.jsx)("button",{onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm transition-colors",children:"Close"})})]})]})}):null},b=s(2066),g=e=>{let{cancellations:t,loading:s,error:r}=e;return s?(0,n.jsx)("div",{className:"flex justify-center items-center py-10",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-10 w-10 border-b-2 border-blue-600"})}):r?(0,n.jsx)("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4",children:(0,n.jsxs)("div",{className:"flex",children:[(0,n.jsx)("div",{className:"flex-shrink-0",children:(0,n.jsx)(o.gJy,{className:"h-5 w-5 text-red-400"})}),(0,n.jsx)("div",{className:"ml-3",children:(0,n.jsx)("p",{className:"text-sm text-red-700",children:"Error loading cancellation data. Please try again later."})})]})}):0===t.length?(0,n.jsx)("div",{className:"bg-gray-50 rounded-lg border border-gray-200 p-6",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(o.NMh,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,n.jsx)("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No cancellations yet"}),(0,n.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Cancellation records will appear here when users cancel their subscriptions."})]})}):(0,n.jsx)("div",{className:"bg-white shadow overflow-hidden sm:rounded-md",children:(0,n.jsx)("ul",{className:"divide-y divide-gray-200",children:t.map(e=>(0,n.jsx)("li",{children:(0,n.jsxs)("div",{className:"px-4 py-4 sm:px-6",children:[(0,n.jsxs)("div",{className:"flex items-center justify-between",children:[(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("p",{className:"text-sm font-medium text-blue-600 truncate",children:e.userId||"Unknown User"}),(0,n.jsx)("div",{className:"ml-2 flex-shrink-0 flex",children:(0,n.jsx)("p",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full ".concat("completed"===e.status?"bg-green-100 text-green-800":"failed"===e.status?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"),children:e.status||"pending"})})]}),(0,n.jsx)("div",{className:"ml-2 flex-shrink-0 flex flex-col items-end",children:(0,n.jsx)("p",{className:"text-sm text-gray-500",children:e.timestamp?(0,b.WU)(new Date(1e3*e.timestamp.seconds),"MMM d, yyyy h:mm a"):"Unknown date"})})]}),(0,n.jsxs)("div",{className:"mt-2 sm:flex sm:justify-between",children:[(0,n.jsx)("div",{className:"sm:flex",children:(0,n.jsx)("p",{className:"flex items-center text-sm text-gray-500",children:e.paymentProvider||"Unknown provider"})}),e.reason&&(0,n.jsx)("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:(0,n.jsxs)("p",{children:["Reason: ",e.reason]})})]})]})},e.id))})})},p=e=>{let{companyData:t,vendorKey:s,handleViewCodeSnippet:r,handleExportData:a=()=>console.log("Export data feature not implemented")}=e;return(0,c.useRouter)(),(0,n.jsxs)("div",{className:"pb-5 border-b border-gray-200 sm:flex sm:items-center sm:justify-between",children:[(0,n.jsxs)("div",{children:[(0,n.jsxs)("h2",{className:"text-lg leading-6 font-medium text-gray-900 flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2 text-blue-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})}),"Dashboard"]}),(0,n.jsxs)("div",{className:"mt-1 flex flex-col sm:flex-row sm:flex-wrap sm:mt-0 sm:space-x-6",children:[(0,n.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:[(0,n.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})}),"Vendor: ",(0,n.jsx)("span",{className:"ml-1 font-medium text-gray-900",children:s})]}),t&&t.company&&(0,n.jsxs)("div",{className:"mt-2 flex items-center text-sm text-gray-500 sm:mt-0",children:[(0,n.jsx)("svg",{className:"flex-shrink-0 mr-1.5 h-5 w-5 text-gray-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",children:(0,n.jsx)("path",{fillRule:"evenodd",d:"M4 4a2 2 0 012-2h8a2 2 0 012 2v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4zm3 1h6v4H7V5zm8 8v2h1v1H4v-1h1v-2H4v-1h16v1h-1z",clipRule:"evenodd"})}),"Company: ",(0,n.jsx)("span",{className:"ml-1 font-medium text-gray-900",children:t.company})]})]})]}),(0,n.jsxs)("div",{className:"mt-4 flex items-center gap-4 sm:mt-0 sm:ml-4",children:[(0,n.jsx)("button",{type:"button",onClick:a,className:"inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Export Data"}),(0,n.jsx)("button",{type:"button",onClick:r,className:"inline-flex items-center px-4 py-2 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"View Code Snippet"})]})]})};let f=[{name:"Red",value:"#ef4444"},{name:"Blue",value:"#3b82f6"},{name:"Green",value:"#10b981"},{name:"Purple",value:"#8b5cf6"},{name:"Pink",value:"#ec4899"},{name:"Orange",value:"#f97316"},{name:"Gray",value:"#6b7280"},{name:"Black",value:"#111827"}];function y(e){let{user:t}=e,[s,l]=(0,r.useState)([]),[i,d]=(0,r.useState)(!0),[x,b]=(0,r.useState)(null),[y,v]=(0,r.useState)(null),[j,w]=(0,r.useState)(null),[N,C]=(0,r.useState)(!1),[k,S]=(0,r.useState)(!1),[E,I]=(0,r.useState)({buttonText:"Cancel subscription",buttonColor:"#ef4444",testMode:!0,customBranding:!1}),M=(0,c.useRouter)(),[T,R]=(0,r.useState)("stripe");(0,r.useEffect)(()=>{(async()=>{try{if(!t){b("No valid user"),d(!1);return}console.log("Fetching vendor data for user:",t.uid);let e=(0,u.hJ)(a.db,"vendors"),s=(0,u.IO)(e,(0,u.ar)("userId","==",t.uid)),n=await (0,u.PL)(s);if(n.empty){console.warn("No vendor data found for user"),console.log("Redirecting to onboarding page..."),M.push("/onboard");return}let r=n.docs[0],l=r.id,o=r.data();console.log("Found vendor data from Firestore:",o),console.log("Vendor key (document ID):",l),v(l),w({...o,vendorKey:l}),_(l),I({buttonText:o.buttonText||"Cancel subscription",buttonColor:o.buttonColor||"#ef4444",testMode:!1!==o.testMode,customBranding:o.customBranding||!1}),d(!1)}catch(e){console.error("Error fetching vendor data from Firestore:",e),b("Failed to load vendor data"),d(!1)}})()},[t,M]);let _=async e=>{try{d(!0),console.log("Fetching cancellations for vendor key:",e);let t=(0,u.hJ)(a.db,"cancels"),s=(0,u.IO)(t,(0,u.ar)("vendorkey","==",e)),n=await (0,u.PL)(s),r=[];n.forEach(e=>{r.push({id:e.id,...e.data()})}),console.log("Fetched cancellation data:",r),l(r),d(!1)}catch(e){console.error("Error fetching cancellations from Firestore:",e),b("Failed to load cancellation data"),d(!1)}},B=()=>(0,m.P)(y,T,{buttonText:E.buttonText,buttonColor:E.buttonColor,testMode:E.testMode,customBranding:E.customBranding}),P=async()=>{try{let e=(0,u.JU)(a.db,"vendors",y);await (0,u.r7)(e,{buttonText:E.buttonText,buttonColor:E.buttonColor,testMode:E.testMode,customBranding:E.customBranding}),alert("Settings saved successfully!"),w(e=>({...e,buttonText:E.buttonText,buttonColor:E.buttonColor,testMode:E.testMode,customBranding:E.customBranding}))}catch(e){console.error("Error saving button settings:",e),alert("Failed to save settings. Please try again.")}};return(0,n.jsx)("div",{className:"py-8",children:(0,n.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 space-y-8",children:i?(0,n.jsx)("div",{className:"flex justify-center items-center p-16",children:(0,n.jsxs)("div",{className:"text-center",children:[(0,n.jsx)(o.fCD,{className:"animate-spin text-blue-500 text-4xl mx-auto mb-4"}),(0,n.jsx)("p",{className:"text-gray-600 font-medium",children:"Loading dashboard data..."})]})}):x?(0,n.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6 mb-8 shadow-sm",children:(0,n.jsxs)("div",{className:"flex items-center",children:[(0,n.jsx)("div",{className:"bg-red-100 p-3 rounded-full mr-4",children:(0,n.jsx)(o.gJy,{className:"text-red-500 text-xl"})}),(0,n.jsxs)("div",{children:[(0,n.jsx)("h3",{className:"text-lg font-semibold text-red-800 mb-1",children:"Error Loading Data"}),(0,n.jsx)("p",{className:"text-red-700",children:x})]})]})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p,{companyData:j,vendorKey:y,handleViewCodeSnippet:()=>C(!0),handleExportData:()=>{alert("Export CSV functionality will be implemented")}}),(0,n.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-8 mt-8",children:[(0,n.jsx)("div",{className:"lg:col-span-3",children:(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200",children:[(0,n.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),"Cancellation Records"]})}),(0,n.jsx)("div",{className:"p-6",children:(0,n.jsx)(g,{cancellations:s,loading:i,error:x})})]})}),(0,n.jsx)("div",{className:"lg:col-span-1",children:(0,n.jsxs)("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200",children:[(0,n.jsx)("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50",children:(0,n.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 flex items-center",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-blue-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),"Quick Actions"]})}),(0,n.jsxs)("div",{className:"p-6 space-y-6",children:[(0,n.jsxs)("button",{type:"button",onClick:()=>C(!0),className:"w-full inline-flex justify-center items-center px-4 py-3 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 20l4-16m4 4l4 4-4 4M6 16l-4-4 4-4"})}),"Get Code Snippet"]}),(0,n.jsxs)("button",{type:"button",onClick:()=>{j?S(!0):M.push("/onboard")},className:"w-full inline-flex justify-center items-center px-4 py-3 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:[(0,n.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-gray-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,n.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})}),"Edit Onboarding Info"]})]})]})})]}),N&&(0,n.jsx)(h,{showCodeSnippet:N,handleCloseCodeSnippet:()=>C(!1),handleCopyCodeSnippet:()=>{let e=B();navigator.clipboard.writeText(e).then(()=>{alert("Code snippet copied to clipboard!")},e=>{console.error("Could not copy text: ",e),alert("Failed to copy code snippet. Please try manually selecting and copying the code.")})},generateCodeSnippet:B,selectedProviderForSnippet:T,setSelectedProviderForSnippet:R,buttonSettings:E,handleButtonSettingChange:(e,t)=>{I(s=>({...s,[e]:t}))},handleSaveSettings:P,colorOptions:f}),k&&(0,n.jsx)("div",{className:"fixed z-10 inset-0 overflow-y-auto",children:(0,n.jsxs)("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[(0,n.jsx)("div",{className:"fixed inset-0 transition-opacity","aria-hidden":"true",children:(0,n.jsx)("div",{className:"absolute inset-0 bg-gray-500 opacity-75"})}),(0,n.jsx)("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true",children:"​"}),(0,n.jsxs)("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[(0,n.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,n.jsxs)("div",{className:"sm:flex sm:items-start",children:[(0,n.jsx)("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-red-100 sm:mx-0 sm:h-10 sm:w-10",children:(0,n.jsx)(o.gJy,{className:"h-6 w-6 text-red-600"})}),(0,n.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[(0,n.jsx)("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title",children:"Warning: Changing Onboarding Settings"}),(0,n.jsx)("div",{className:"mt-2",children:(0,n.jsx)("p",{className:"text-sm text-gray-500",children:"Changing your onboarding settings will create a new vendor ID and delete your current configuration data. This action cannot be undone. Are you sure you want to continue?"})})]})]})}),(0,n.jsxs)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[(0,n.jsx)("button",{type:"button",onClick:()=>{S(!1),M.push("/onboard")},className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-red-600 text-base font-medium text-white hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Yes, Continue"}),(0,n.jsx)("button",{type:"button",onClick:()=>S(!1),className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancel"})]})]})]})})]})})})}function v(){let{user:e,loading:t}=(0,r.useContext)(d.AuthContext),s=(0,c.useRouter)();return t?(0,n.jsx)(i.Z,{children:(0,n.jsx)("div",{className:"flex justify-center items-center min-h-screen bg-gray-50",children:(0,n.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e?(0,n.jsx)(i.Z,{children:(0,n.jsx)(y,{user:e})}):(s.push("/login?redirect=/dashboard"),null)}function j(){return(0,n.jsx)(l.Z,{children:(0,n.jsx)(v,{})})}},6450:function(e,t,s){"use strict";function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"paddle",s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{buttonText:n,buttonColor:r,testMode:a,customBranding:l}=s;return"<!-- CancelReady Cancel Button - Just copy and paste this code where you want the button to appear -->\n<button \n  onclick=\"window.open('https://cancelready.web.app/cancel?vendorKey=".concat(e,"&subscriptionId=THE_END_USERS_ACTUAL_SUBSCRIPTION_ID&paymentProvider=").concat(t).concat(a?"&testMode=true":"").concat(l?"&customBranding=true":"","', '_blank')\"\n  style=\"background-color: ").concat(r||"#ef4444",'; color: white; border: none; padding: 8px 16px; border-radius: 4px; cursor: pointer; font-family: system-ui, -apple-system, sans-serif; font-size: 14px;"\n  onmouseover="this.style.opacity=\'0.9\'"\n  onmouseout="this.style.opacity=\'1\'"\n>\n  ').concat(n||"Cancel subscription","\n</button>\n\n<!-- That's it! Just replace THE_END_USERS_ACTUAL_SUBSCRIPTION_ID with the user's actual subscription ID -->\n<!-- Example for Stripe: sub_1234567890 -->\n<!-- Example for Paddle: sub_123456 -->\n\n<!-- No JavaScript initialization required! -->")}function r(){return'\n<div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 mb-4">\n  <p class="text-sm text-yellow-700">\n    <strong>Important:</strong> Replace <code>YOUR_USER_ID</code> with the user identifier that matches exactly how you\'ve stored it in your payment processor:\n  </p>\n  <ul class="list-disc ml-5 mt-2 text-sm text-yellow-700">\n    <li>For <strong>Stripe</strong>: Use the same ID stored in subscription metadata as \'userId\'</li>\n    <li>For <strong>Paddle</strong>: Use the same ID stored in subscription passthrough field as \'userId\'</li>\n  </ul>\n  <p class="text-sm text-yellow-700 mt-2">\n    If the user IDs don\'t match exactly, cancellation requests will fail.\n  </p>\n</div>'}s.d(t,{P:function(){return n},u:function(){return r}})}},function(e){e.O(0,[445,867,566,191,888,774,179],function(){return e(e.s=1015)}),_N_E=e.O()}]);